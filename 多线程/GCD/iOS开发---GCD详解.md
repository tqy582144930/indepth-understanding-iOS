[TOC]

# iOS开发---GCD详解

## 什么是GCD？

- 百度百科给出了如下解释

> **Grand Central Dispatch (GCD)**是Apple开发的一个多核编程的较新的解决方法。它主要用于优化应用程序以支持多核处理器以及其他对称多处理系统。它是一个在线程池模式的基础上执行的并行任务。在Mac OS X 10.6雪豹中首次推出，也可在iOS 4及以上版本使用。

- GCD的好处
  1. GCD是苹果公司为多核的并行运算提出的解决方案
  2. GCD会自动利用更多的CPU内核（比如双核、四核）
  3. GCD会自动管理线程的生命周期（创建线程、调度任务、销毁线程）
  4. 程序员只需要告诉GCD想要执行什么任务，不需要编写任何线程管理代码

## 任务和队列

- 在学习GCD之前，先来了解GCD 中两个核心概念：**任务** 和 **队列**。

### 任务

- 执行某种操作，就是放在block中的代码。执行任务有两种方式：
  1. **同步执行（sync）**
     - 只能在当前线程中执行任务，不具备开启新线程的能力
     - 任务立刻马上执行，会阻塞当前线程并等待 Block中的任务执行完毕，然后当前线程才会继续往下运行
  2. **异步执行（async）**
     - 可以在新的线程中执行任务，具备开启新线程的能力，但不一定会开新线程
     - 当前线程会直接往下执行，不会阻塞当前线程

### 队列

- 存放任务的队列，仍然遵循FIFO（先进先出）的原则。在 GCD 中有两种队列：**串行队列** 和 **并发队列**。两者的主要区别是：执行顺序不同，以及开启线程数不同。
  1. **串行队列（Serial Dispatch Queue）**
     - 让任务一个接着一个地执行（一个任务执行完毕后，再执行下一个任务）
  2. **并发队列（Concurrent Dispatch Queue）**
     - 可以让多个任务并发（同时）执行（自动开启多个线程同时执行任务）并发功能只有在异步（dispatch_async）函数下才有效

## GCD的创建

## 任务和队列的组合

### 1.同步执行 + 并发队列

### 2.异步执行 + 并发队列

### 3.同步执行 + 串行队列

### 4.异步执行 + 串行队列

### 5.同步执行 + 主队列

### 6.异步执行 + 主队列

## GCD其他方法

### 1.栅栏方法：dispatch_barrier_async

### 2.延时执行方法：dispatch_after

### 3.一次性代码：dispatch_once

### 4.快速迭代方法：dispatch_apply

### 5.队列组：dispatch_group

### 6.信号量：dispatch_semaphore
